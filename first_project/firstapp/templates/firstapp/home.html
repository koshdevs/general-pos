
 {% extends 'firstapp/base.html' %}       
        <!-- Main content -->
    {% block mainContent %}
        <section class="content">
          <div class="container-fluid">
            <!-- Small boxes (Stat box) -->
            <div class="row">
             
              <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-dark">
                  <div class="inner">
                    <h3>KES {{orders}}</h3>
                    
                    <p>Today profit</p>
                  </div>
                  <div class="icon">
                    <i class="ion ion-bag"></i>
                  </div>
                  <a href="#" class="small-box-footer">view more <i class="fas fa-arrow-circle-right"></i></a>
                </div>
              </div>
              <!-- ./col -->
              <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-success">
                  <div class="inner">
                    <h3>KES {{amount}}<sup style="font-size: 20px"></sup></h3>
                    
                    <p>Today Amount</p>
                  </div>
                  <div class="icon">
                    <i class="ion ion-stats-bars"></i>
                  </div>
                  <a href="#" class="small-box-footer">view more <i class="fas fa-arrow-circle-right"></i></a>
                </div>
              </div>
              <!-- ./col -->
              <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-primary">
                  <div class="inner">
                    <h3>{{ sales }}</h3>
                    
                    <p>Today qty Sales</p>
                  </div>
                  <div class="icon">
                    <i class="ion ion-person-add"></i>
                  </div>
                  <a href="{% url 'firstapp-sales' %}" class="small-box-footer">view more<i class="fas fa-arrow-circle-right"></i></a>
                </div>
              </div>
              <!-- ./col -->
              <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-danger">
                  <div class="inner">
                    <h3>{{ stocks }}</h3>
                    
                    <p>Stock Levels</p>
                  </div>
                  <div class="icon">
                    <i class="ion ion-pie-graph"></i>
                  </div>
                  <a href="{% url 'firstapp-stocks' %}" class="small-box-footer">view more <i class="fas fa-arrow-circle-right"></i></a>
                </div>
              </div>
         
              
              <!-- ./col -->
            </div>

          <div class="row">
              
              <div class="col-lg-3 col-6">

               <div class="small-box bg-outline">
                <h4 id="status" style="margin-left:50px;"> status </h4>
            <button type="button" id="cBtn" onclick="getLoc()" class="btn btn-secondary btn-circle btn-xl"><span id="clockBtn">time</span></button>
              </div>

               
                
              </div>

              <div class="col-lg-3 col-6">
               <div class="small-box bg-info">
                    <table class="table">
  <thead class="thead-light">
    <tr>
      <th scope="col">#</th>
      
      <th scope="col">assigned_by</th>
      <th scope="col">status</th>
    </tr>
  </thead>
  <tbody>
    {% for task in tasks %}
    <tr>
      {% if task.task_status == "pending" %}
      <th scope="row"><input type="checkbox" value="pending"></th>
      {% else %}
       <th scope="row"><input type="checkbox" value="done"></th>
       {% endif %}
     
      <th>{{ task.task_creator }}</th>
      <th>{{ task.task_status }}</th>

    </tr>
    {% endfor %}
  </tbody>
</table>
<a href="{% url 'firstapp-taskslist' %}" class="small-box-footer">view tasks <i class="fas fa-arrow-circle-right"></i></a>



              </div>
                
              </div>


              <div class="col-lg-3 col-6">
               <div class="small-box bg-secondary">
                     <p> important </p>
              </div>
                
              </div>
              <div class="col-lg-3 col-6">
               <div class="small-box bg-info">
                    <p> reminders </p>
              </div>
                
              </div>
                 
             </div>

          </div>
        </section>

            <style>
                  .btn-circle.btn-xl {
            width: 150px;
            height: 100px;
            padding: 10px 16px;
            border-radius: 35px;
            font-size: 12px;
            text-align: center;
            margin-left: 50px;
            margin-top:20px;
            margin-bottom: 40px;
            vertical-align: middle;
            
        }

            </style>

            <script>

              function getLoc(){
                  
              

                  if (navigator.geolocation){

                     navigator.geolocation.getCurrentPosition(sendLoc)
                  }else{
                    alert("failed")
                  }
              }

              function sendLoc(position){

                var lat = position.coords.latitude
                var long = position.coords.longitude

                $.ajax({

                type:"POST",
                url: "{% url 'firstapp-location' %}",

                data: {

                  lat:lat,
                  long:long,
                  csrfmiddlewaretoken:'{{ csrf_token }}'
                },

                success:function(data,status){

                    alert("clock in successfully")
                }

                })

                

              }

              function errorLoc(error){

                if (error.PERMISSION_DENIED){

                   alert("access denied")
                }
              }
              
             // creatint the clock 
              setInterval(showTime, 1000);
              function showTime() {
                  let time = new Date();
                  let hour = time.getHours();
                  let min = time.getMinutes();
                  let sec = time.getSeconds();
                  am_pm = "AM";
                
                  if (hour > 12) {
                      hour -= 12;
                      am_pm = "PM";

                  }
                  if (hour == 0) {
                      hr = 12;
                      am_pm = "AM";

                  }
                  if(hour > 8){

                       document.getElementById('status').innerHTML = "late"
                       document.getElementById('status').style.color = "red"
                       document.getElementById('cBtn').style.background = "red"

                  }
                
                  hour = hour < 10 ? "0" + hour : hour;
                  min = min < 10 ? "0" + min : min;
                  sec = sec < 10 ? "0" + sec : sec;
                
                  let currentTime = hour + ":" 
                          + min + ":" + sec + am_pm;
                
                  document.getElementById("clockBtn")
                          .innerHTML = currentTime;
              }
              showTime();


          // update confirmed tasks 



</script>

 
            
          
    {% endblock mainContent %}

  